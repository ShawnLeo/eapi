(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7b6930ea"],{"026d":function(t,e,o){"use strict";var r=o("4ae9"),a=o.n(r);a.a},"4ae9":function(t,e,o){},bdd2:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Row",{staticClass:"settings"},[o("Form",{ref:"projectItem",staticStyle:{"margin-top":"15px"},attrs:{model:t.project,"label-width":90,rules:t.ruleValidate}},[t.spinShow?o("Spin",{attrs:{size:"large",fix:""}}):t._e(),o("i-col",{attrs:{span:"24"}},[o("div",{staticClass:"wrapper-content"},[o("h2",{staticClass:"title-border"},[t._v("项目信息")])]),o("div",{staticClass:"wrapper-content box"},[o("FormItem",{attrs:{label:"项目名称",prop:"title"}},[o("Input",{attrs:{placeholder:"项目名称"},model:{value:t.project.title,callback:function(e){t.$set(t.project,"title",e)},expression:"project.title"}})],1),o("Row",[o("i-col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"项目版本",prop:"version"}},[o("Input",{attrs:{placeholder:"文档版本"},model:{value:t.project.version,callback:function(e){t.$set(t.project,"version",e)},expression:"project.version"}})],1)],1),o("i-col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"联系人邮箱",prop:"contactEmail"}},[o("Input",{attrs:{placeholder:"联系人邮箱"},model:{value:t.project.contactEmail,callback:function(e){t.$set(t.project,"contactEmail",e)},expression:"project.contactEmail"}})],1)],1)],1),o("Row",[o("i-col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"域名",prop:"host"}},[o("Input",{attrs:{placeholder:"域名"},model:{value:t.project.host,callback:function(e){t.$set(t.project,"host",e)},expression:"project.host"}})],1)],1),o("i-col",{attrs:{span:"12"}},[o("FormItem",{attrs:{label:"基础路径",prop:"basePath"}},[o("Input",{attrs:{placeholder:"基础路径"},model:{value:t.project.basePath,callback:function(e){t.$set(t.project,"basePath",e)},expression:"project.basePath"}})],1)],1)],1),o("FormItem",{attrs:{label:"项目描述",prop:"description"}},[o("i-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"项目描述"},model:{value:t.project.description,callback:function(e){t.$set(t.project,"description",e)},expression:"project.description"}})],1),o("FormItem",{attrs:{label:"发布地址"}},[o("Input",{attrs:{placeholder:"发布构建地址"},model:{value:t.project.deployUrl,callback:function(e){t.$set(t.project,"deployUrl",e)},expression:"project.deployUrl"}})],1),o("FormItem",[o("Button",{staticStyle:{float:"right"},on:{click:t.updateProject}},[t._v("保存")])],1)],1)]),o("i-col",{attrs:{span:"24"}},[o("div",{staticClass:"wrapper-content"},[o("h2",{staticClass:"title-border"},[t._v("导入/导出")])]),o("div",{staticClass:"wrapper-content box clearfix"},[o("div",{staticStyle:{float:"left",width:"50%","padding-left":"30px","border-right":"1px solid #d1d5da"}},[o("h3",[o("Icon",{attrs:{type:"ios-cloud-download-outline"}}),t._v(" 导出swagger文档")],1),o("br"),o("p",[t._v("说明:")]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v("导出标准格式的swagger.json文档")]),o("br"),o("br"),o("Button",{attrs:{type:"success"},on:{click:t.exportSwagger}},[t._v("导出")]),o("br"),o("br")],1),o("div",{staticStyle:{float:"right",width:"50%","padding-left":"60px"}},[o("h3",[o("Icon",{attrs:{type:"ios-cloud-upload-outline"}}),t._v(" 导入swagger文档")],1),o("br"),o("p",[t._v("说明:")]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v("1.导入格式只支持标准的swagger.json")]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v("2.导入swagger.json会导致现有数据丢失")]),o("br"),o("Button",{attrs:{type:"info"},on:{click:t.importSwagger}},[t._v("导入")])],1)])]),o("i-col",{attrs:{span:"24"}},[o("div",{staticClass:"wrapper-content"},[o("h2",{staticClass:"title-border"},[t._v("通用响应")])]),o("div",{staticClass:"wrapper-content box clearfix"},[o("p",[t._v("说明:")]),o("p",{staticStyle:{"text-indent":"2em"}},[t._v("开启通用响应，选择通用数据模型，所有的 "),o("b",[t._v("接口返回值")]),t._v("都会变成"),o("b",[t._v("通用响应模型的数据结构")]),t._v("。\n\t\t\t\t\t\t导出的swagger.json不会受影响")]),o("Form",{staticStyle:{"margin-top":"15px"},attrs:{model:t.project,"label-width":90}},[o("FormItem",{attrs:{label:"通用响应"}},[o("i-switch",{model:{value:t.project.commonResponse,callback:function(e){t.$set(t.project,"commonResponse",e)},expression:"project.commonResponse"}})],1),t.project.commonResponse?o("FormItem",{staticStyle:{width:"500px"},attrs:{label:"通用数据模型"}},[o("Select",{model:{value:t.project.commonResponseId,callback:function(e){t.$set(t.project,"commonResponseId",e)},expression:"project.commonResponseId"}},t._l(t.customDataModel,(function(e){return o("Option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])})),1)],1):t._e(),t.project.commonResponse?o("FormItem",{staticStyle:{width:"500px"},attrs:{label:"字段名"}},[o("Input",{attrs:{placeholder:"字段名，默认值：data"},model:{value:t.project.commonResponseField,callback:function(e){t.$set(t.project,"commonResponseField",e)},expression:"project.commonResponseField"}})],1):t._e(),o("FormItem",[o("Button",{staticStyle:{float:"right"},attrs:{type:"success"},on:{click:t.updateProject}},[t._v("保存")])],1)],1)],1)]),o("i-col",{attrs:{span:"24"}},[o("div",{staticClass:"wrapper-content"},[o("h2",{staticClass:"title-border"},[t._v("删除此项目")])]),o("div",{staticClass:"wrapper-content box danger-box"},[o("p",[t._v("此操作不可逆，将删除"),o("b",[t._v(t._s(t.project.title))]),t._v("项目, 及项目下接口、数据模型和标签等全部内容，且"),o("b",[t._v("不可恢复")]),t._v("！")]),o("br"),o("p",[t._v("请输入项目名称以进行确认:")]),o("br"),o("Input",{attrs:{placeholder:"项目名称"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),o("br"),o("br"),o("FormItem",{attrs:{"label-width":-1}},[t.showDeleteButton?o("Button",{attrs:{type:"error",long:""},on:{click:t.handleRemove}},[t._v("我已了解风险，删除此项目")]):o("Button",{attrs:{type:"error",long:"",disabled:""}},[t._v("我已了解风险，删除此项目")])],1)],1)])],1),o("Modal",{attrs:{title:"导入"},on:{"on-ok":t.okImport,"on-cancel":t.cancelImport},model:{value:t.showImportModal,callback:function(e){t.showImportModal=e},expression:"showImportModal"}},[o("Tabs",{attrs:{value:"name1"}},[o("TabPane",{attrs:{label:"本地导入",name:"name1"}},[o("Upload",{attrs:{multiple:"","on-success":t.handleSuccess,"on-error":t.handleError,type:"drag",action:t.uploadUrl,headers:t.headers}},[o("div",{staticStyle:{padding:"20px 0"}},[o("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),o("p",[t._v("点击或拖拽上传")])],1)])],1),o("TabPane",{attrs:{label:"URL导入",name:"name2"}},[o("Form",{staticStyle:{"margin-top":"20px"},attrs:{"label-width":80}},[o("FormItem",{attrs:{label:"URL地址"}},[o("Input",{attrs:{placeholder:"能直接访问的Swagger Json的URL地址"},model:{value:t.swaggerUrl,callback:function(e){t.swaggerUrl=e},expression:"swaggerUrl"}})],1)],1)],1)],1)],1)],1)},a=[],s=(o("96cf"),o("3b8d")),n=o("ae31"),c=o("5d2d"),l=o("37b6"),i=o("1c1e"),p=o("e490"),d={name:"setting",data:function(){var t=this,e=function(e,o,r){Object(n["d"])(t.project,(function(t){"0"===t.header.code?t.body?r(new Error("项目名称已存在")):r():r(new Error(t.header.message))}))};return{spinShow:!1,showDeleteButton:!1,customDataModel:[],project:{},title:"",uploadUrl:"",headers:{Authorization:"Bearer "+Object(c["a"])(l["a"])},swaggerUrl:"",showImportModal:!1,ruleValidate:{title:[{required:!0,message:"请输入项目名称",trigger:"blur"},{validator:e,trigger:"blur"}],version:[{required:!0,message:"请输入版本号",trigger:"blur"}],contactEmail:[{required:!0,message:"请输入邮箱",trigger:"blur"}],host:[{required:!0,message:"请输入域名",trigger:"blur"}],basePath:[{required:!0,message:"请输入基础路径",trigger:"blur"}],description:[{required:!0,message:"请输入项目描述",trigger:"blur"}]}}},methods:{init:function(){this.uploadUrl=p["a"]+"/swagger/import/file/"+this.projectId,this.getProjectById(),this.customDataModel=JSON.parse(Object(c["a"])("customDataModel"))},getProjectById:function(){var t=this;Object(n["J"])({id:this.projectId},(function(e){t.project=e.body,t.$store.dispatch("project",e.body)}))},updateProject:function(){var t=this;this.$refs["projectItem"].validate(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(o){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o&&(t.spinShow=!0,Object(n["db"])(t.project,(function(e){"0"===e.header.code?(t.$Message.success("更新成功！"),t.init()):t.$Message.error(e.header.message),t.spinShow=!1})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},exportSwagger:function(){var t=this;Object(n["v"])({projectId:this.project.id},(function(e){t.download(e)}))},download:function(t){if(t){var e=window.URL.createObjectURL(new Blob([t])),o=document.createElement("a");o.style.display="none",o.href=e,o.setAttribute("download","swagger.json"),document.body.appendChild(o),o.click()}},importSwagger:function(){var t=this;this.$Modal.confirm({title:"提示",content:'<p>导入仅支持标准的swagger.json，且会导致现有<span style="color: red;font-weight: bold;">数据丢失</span>，确认继续操作么？</p>',okText:"确认",cancelText:"取消",onOk:function(){t.showImportModal=!0}})},handleSuccess:function(t,e){var o=this;Object(i["b"])(t,{callback:function(){o.$Message.success("数据导入成功！"),o.showImportModal=!1}})},handleError:function(t,e){this.$Message.error(t.message)},handleRemove:function(){var t=this;Object(n["m"])({id:this.project.id},(function(e){t.$Message.success("删除成功！"),t.$router.push({path:"/project/list"})}))},okImport:function(){var t=this;Object(n["X"])({projectId:this.project.id,swaggerUrl:this.swaggerUrl},(function(e){t.$Message.success("导入成功！"),t.swaggerUrl="",t.showImportModal=!1}))},cancelImport:function(){this.showImportModal=!1}},computed:{state:function(){return this.$store.state.app},projectId:function(){return this.$store.state.app.projectId||Object(c["a"])("projectId")}},mounted:function(){this.init()},watch:{title:function(t,e){this.showDeleteButton=t===this.project.title}}},u=d,m=(o("026d"),o("2877")),h=Object(m["a"])(u,r,a,!1,null,"57266229",null);e["default"]=h.exports}}]);