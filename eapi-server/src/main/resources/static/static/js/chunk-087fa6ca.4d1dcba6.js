(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-087fa6ca"],{"0a2d":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"project-datamodel"},[a("Form",{ref:"formInline",staticClass:"project-datamodel-form",attrs:{inline:""}},[a("FormItem",[a("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.newDatamodel}},[e._v("新建模型")])],1),a("FormItem",{attrs:{prop:"search"}},[a("Input",{attrs:{type:"text",placeholder:"名称搜索"},on:{"on-keyup":e.searchData},model:{value:e.searchModel,callback:function(t){e.searchModel=t},expression:"searchModel"}})],1)],1),a("div",{staticClass:"clearfix"}),a("Form",{directives:[{name:"show",rawName:"v-show",value:e.showEditMenus,expression:"showEditMenus"}],ref:"formInline",staticClass:"project-datamodel-form form-in-table",attrs:{inline:""}},[a("Button",{attrs:{size:"small"},on:{click:e.deleteDataModel}},[e._v("删除")])],1),a("Table",{ref:"selection",attrs:{loading:e.loading,stripe:"",columns:e.columns,data:e.filterDatamodels},on:{"on-selection-change":e.onCelectionChange}}),a("add-data-model",{attrs:{addDataModelModal:e.addDataModelModal},on:{closeModal:e.closeModal}})],1)},o=[],r=(a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Modal",{attrs:{closable:!1,title:"新建数据模型",width:"1000","mask-closable":!1},model:{value:e.addDataModelModal,callback:function(t){e.addDataModelModal=t},expression:"addDataModelModal"}},[a("a",{staticClass:"ivu-modal-close",on:{click:e.closeModal}},[a("i",{staticClass:"ivu-icon ivu-icon-ios-close-empty"})]),a("div",{staticClass:"project-datamodel-add"},[a("Form",{ref:"datamodelForm",staticStyle:{"margin-top":"30px"},attrs:{model:e.formItem,"label-width":80,rules:e.ruleValidate}},[a("FormItem",{staticStyle:{width:"60%"},attrs:{label:"模型名称",prop:"name"}},[a("i-input",{attrs:{placeholder:"例如：User"},model:{value:e.formItem.name,callback:function(t){e.$set(e.formItem,"name",t)},expression:"formItem.name"}})],1),a("FormItem",{staticStyle:{width:"60%"},attrs:{label:"描述",prop:"description"}},[a("i-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:5},placeholder:"描述"},model:{value:e.formItem.description,callback:function(t){e.$set(e.formItem,"description",t)},expression:"formItem.description"}})],1),a("FormItem",{attrs:{label:"类别"}},[a("RadioGroup",{attrs:{type:"button",size:"small"},on:{"on-change":e.dataTypeChange},model:{value:e.formItem.dataType,callback:function(t){e.$set(e.formItem,"dataType",t)},expression:"formItem.dataType"}},e._l(e.systemDataModel,(function(e,t){return a("Radio",{key:t,attrs:{label:e.dataType}})})),1)],1),a("FormItem",{attrs:{label:"属性"}},["object"===e.formItem.dataType?a("hash-table",{attrs:{rows:e.formItem.children,name:e.formItem.name,level:1},on:{childrenChange:e.childrenChange}}):e._e(),"array"===e.formItem.dataType?a("array-table",{attrs:{rows:e.formItem.children,name:e.formItem.name,level:1}}):e._e(),"enum"===e.formItem.dataType?a("enum-table",{attrs:{rows:e.formItem.children,level:1}}):e._e(),"string"===e.formItem.dataType?a("string-table",{attrs:{rows:e.formItem.children,level:1}}):e._e(),"integer"===e.formItem.dataType?a("number-table",{attrs:{rows:e.formItem.children,level:1}}):e._e(),"boolean"===e.formItem.dataType?a("boolean-table",{attrs:{rows:e.formItem.children,level:1}}):e._e(),"file"===e.formItem.dataType?a("file-table",{attrs:{rows:e.formItem.children,level:1}}):e._e()],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text",size:"large"},on:{click:e.closeModal}},[e._v("取消")]),a("Button",{attrs:{type:"primary",size:"large"},on:{click:e.create}},[e._v("保存")])],1)])}),i=[],s=(a("ac6a"),a("96cf"),a("3b8d")),l=a("d396"),c=a("cd5a"),d=a("e8b0"),u=a("a493"),m=a("6a81"),p=a("c85b"),h=a("5ac7"),f=a("ae31"),v=a("5d2d"),w={name:"add-data-model",data:function(){var e=this,t=function(t,a,n){Object(f["b"])(e.formItem,(function(e){"0"===e.header.code?e.body?n(new Error("数据模型已存在")):n():n(new Error(e.header.message))}))};return{systemDataModel:[],typeBak:"object",formItem:{name:"",dataType:"object",projectId:"",description:"",children:[{name:"",description:"",dataType:"string",example:"",required:!1,children:[],_expanded:!1}]},ruleValidate:{name:[{required:!0,message:"请输入模型名称",trigger:"blur"},{type:"string",max:100,message:"输入小于100个字符",trigger:"blur"},{validator:t,trigger:"blur"}],description:[{type:"string",max:500,message:"输入小于100个字符",trigger:"blur"}]}}},props:{addDataModelModal:{type:Boolean,default:!1}},computed:{state:function(){return this.$store.state.app}},components:{hashTable:l["a"],enumTable:c["a"],arrayTable:d["a"],stringTable:u["a"],numberTable:m["a"],booleanTable:p["a"],fileTable:h["a"]},methods:{init:function(){this.formItem.projectId=this.state.projectId||Object(v["a"])("projectId"),this.getDataModelList()},getDataModelList:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(f["F"])({type:"system"},(function(e){"0"===e.header.code?t.systemDataModel=e.body:t.$Message.error(e.header.message)}));case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),joint:function(e,t){var a=this;t.forEach((function(t){t.children&&t.children.length>0?t.name&&(e[t.name]={},a.joint(e[t.name],t.children)):e[t.name]=t.example}))},childrenChange:function(e){JSON.stringify(this.formItem.children)!==JSON.stringify(e)&&(this.formItem.children=e)},dataTypeChange:function(e){var t=this;this.$Modal.confirm({title:"确认切换？",content:"<p>切换类型将导致现有数据丢失！</p><p>你确认要切换成“"+e+"”码？</p>",onOk:function(){t.typeBak=t.formItem.dataType,t.formItem.children=[],t.formItem.children.push({name:"",description:"",dataType:"string",example:"",required:!1,children:[],_expanded:!1})},onCancel:function(){t.formItem.dataType=t.typeBak}})},deleteDataModel:function(e,t){for(var a=this,n=[],o=0;o<e.length;o++)e[o].id&&n.push(e[o]);n.length>0?Object(f["k"])(n,(function(e){"0"===e.header.code?t():a.$Message.error(e.header.message)})):t()},create:function(){var e=this;this.$refs["datamodelForm"].validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}return t.next=3,Object(f["g"])(e.formItem,(function(t){"0"===t.header.code?(e.$Message.success("添加成功"),e.closeModal()):e.$Message.error(t.header.message)}));case 3:t.next=6;break;case 5:e.$Message.error("Fail!");case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},closeModal:function(){this.formItem={name:"",dataType:"object",projectId:this.state.projectId||Object(v["a"])("projectId"),description:"",children:[{name:"",description:"",dataType:"string",example:"",required:!1,children:[],_expanded:!1}]},this.typeBak="object",this.$emit("closeModal")}},mounted:function(){this.init()}},b=w,y=a("2877"),x=Object(y["a"])(b,r,i,!1,null,null,null),g=x.exports,I={name:"datamodel",data:function(){var e=this;return{loading:!1,spinShow:!1,showEditMenus:!1,addDataModelModal:!1,columns:[{type:"selection",width:58,align:"center"},{title:"名称",key:"name",render:function(t,a){return t("a",{on:{click:function(){e.$router.push({path:"/project/datamodel/edit",query:{id:a.row.id}})}}},a.row.name)}},{title:"描述",key:"description"},{title:"创建人",key:"createrUserName"},{title:"创建时间",key:"createTime",sortable:!0,render:function(e,t){return e("span",t.row.createTime.substring(0,10))}}],selection:[],filterDatamodels:[],datamodels:[],searchModel:""}},components:{addDataModel:g},computed:{projectId:function(){return this.$store.state.app.projectId||Object(v["a"])("projectId")},state:function(){return this.$store.state.app}},methods:{init:function(){this.getDataModelList()},getDataModelList:function(){var e=this;this.loading=!0,Object(f["D"])({projectId:this.projectId},(function(t){e.datamodels=t.body,e.filterDatamodels=t.body,e.$store.dispatch("customDataModel",t.body),e.loading=!1}))},deleteDataModel:function(){var e=this;this.$Modal.confirm({title:"确认删除？",content:"<p>删除数据不可恢复！</p><p>确认要删除吗？</p>",onOk:function(){Object(f["k"])(e.selection,(function(t){e.$Message.success("删除成功！"),e.showEditMenus=!1,e.init()}))},onCancel:function(){e.$Message.success("取消删除！")}})},onCelectionChange:function(e){this.showEditMenus=0!==e.length,this.selection=e},newDatamodel:function(){this.addDataModelModal=!0},closeModal:function(){this.init(),this.addDataModelModal=!1},searchData:function(){var e=this;this.filterDatamodels=this.datamodels.filter((function(t){return t.name.toLowerCase().indexOf(e.searchModel.toLowerCase())>-1}))}},mounted:function(){this.init()}},M=I,j=(a("2d68"),Object(y["a"])(M,n,o,!1,null,null,null));t["default"]=j.exports},"2d68":function(e,t,a){"use strict";var n=a("6c56"),o=a.n(n);o.a},"5ac7":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-project-hashTable"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:e.showIcon,expression:"showIcon"}],staticStyle:{position:"relative",left:"180px",top:"-6px","z-index":"2",color:"#dddee1"},attrs:{type:"arrow-up-b"}}),a("Table",{staticClass:"datamodel-table",attrs:{columns:e.columns10,data:e.rows}})],1)},o=[],r=(a("c5f6"),{props:{rows:Array,level:Number,showIcon:Boolean},data:function(){var e=this;return{columns10:[{title:"描述",key:"description",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-describe-"+a.index,value:a.row.description,placeholder:"描述"},on:{"on-blur":function(t){e.rows[a.index].description=t.target.value}}})])}}]}},methods:{init:function(){}},watch:{rows:{handler:function(e,t){this.$emit("childrenChange",e)},deep:!0}},mounted:function(){this.init()}}),i=r,s=(a("c444"),a("2877")),l=Object(s["a"])(i,n,o,!1,null,null,null);t["a"]=l.exports},6071:function(e,t,a){"use strict";var n=a("ab45"),o=a.n(n);o.a},"6a81":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-project-hashTable"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:e.showIcon,expression:"showIcon"}],staticStyle:{position:"relative",left:"180px",top:"-6px","z-index":"2",color:"#dddee1"},attrs:{type:"arrow-up-b"}}),a("Table",{staticClass:"datamodel-table",attrs:{columns:e.columns10,data:e.rows}})],1)},o=[],r=(a("c5f6"),{props:{rows:Array,level:Number,showIcon:Boolean},data:function(){var e=this;return{columns10:[{title:"描述",key:"description",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-describe-"+a.index,value:a.row.description,placeholder:"描述"},on:{"on-blur":function(t){e.rows[a.index].description=t.target.value}}})])}},{title:"默认值",key:"example",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-name-"+a.index,value:a.row.example,placeholder:"默认值"},on:{"on-blur":function(t){e.rows[a.index].example=t.target.value}}})])}}]}},methods:{init:function(){}},watch:{rows:{handler:function(e,t){this.$emit("childrenChange",e)},deep:!0}},mounted:function(){this.init()}}),i=r,s=(a("9fd2"),a("2877")),l=Object(s["a"])(i,n,o,!1,null,null,null);t["a"]=l.exports},"6c56":function(e,t,a){},"84cf":function(e,t,a){"use strict";var n=a("fe6c"),o=a.n(n);o.a},"9e17":function(e,t,a){},"9fd2":function(e,t,a){"use strict";var n=a("d44b"),o=a.n(n);o.a},a493:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-project-hashTable"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:e.showIcon,expression:"showIcon"}],staticStyle:{position:"relative",left:"180px",top:"-6px","z-index":"2",color:"#dddee1"},attrs:{type:"arrow-up-b"}}),a("Table",{staticClass:"datamodel-table",attrs:{columns:e.columns10,data:e.rows}})],1)},o=[],r=(a("c5f6"),{props:{rows:Array,level:Number,showIcon:Boolean},data:function(){var e=this;return{columns10:[{title:"描述",key:"description",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-describe-"+a.index,value:a.row.description,placeholder:"描述"},on:{"on-blur":function(t){e.rows[a.index].description=t.target.value}}})])}},{title:"默认值",key:"example",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-name-"+a.index,value:a.row.example,placeholder:"默认值"},on:{"on-blur":function(t){e.rows[a.index].example=t.target.value}}})])}}]}},methods:{init:function(){}},watch:{rows:{handler:function(e,t){this.$emit("childrenChange",e)},deep:!0}},mounted:function(){this.init()}}),i=r,s=(a("6071"),a("2877")),l=Object(s["a"])(i,n,o,!1,null,null,null);t["a"]=l.exports},ab45:function(e,t,a){},c444:function(e,t,a){"use strict";var n=a("9e17"),o=a.n(n);o.a},c85b:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-project-hashTable"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:e.showIcon,expression:"showIcon"}],staticStyle:{position:"relative",left:"180px",top:"-6px","z-index":"2",color:"#dddee1"},attrs:{type:"arrow-up-b"}}),a("Table",{staticClass:"datamodel-table",attrs:{columns:e.columns10,data:e.rows}})],1)},o=[],r=(a("c5f6"),{props:{rows:Array,level:Number,showIcon:Boolean},data:function(){var e=this;return{columns10:[{title:"描述",key:"description",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-describe-"+a.index,value:a.row.description,placeholder:"描述"},on:{"on-blur":function(t){e.rows[a.index].description=t.target.value}}})])}},{title:"默认值",key:"example",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-name-"+a.index,value:a.row.example,placeholder:"默认值"},on:{"on-blur":function(t){e.rows[a.index].example=t.target.value}}})])}}]}},methods:{init:function(){}},watch:{rows:{handler:function(e,t){this.$emit("childrenChange",e)},deep:!0}},mounted:function(){this.init()}}),i=r,s=(a("84cf"),a("2877")),l=Object(s["a"])(i,n,o,!1,null,null,null);t["a"]=l.exports},cd5a:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"components-project-hashTable"},[a("Icon",{directives:[{name:"show",rawName:"v-show",value:e.showIcon,expression:"showIcon"}],staticStyle:{position:"relative",left:"180px",top:"-6px","z-index":"2",color:"#dddee1"},attrs:{type:"arrow-up-b"}}),a("Table",{staticClass:"datamodel-table",attrs:{columns:e.columns10,data:e.rows}})],1)},o=[],r=(a("7f7f"),a("c5f6"),a("ae31")),i={props:{rows:Array,level:Number,showIcon:Boolean},data:function(){var e=this;return{columns10:[{title:"值",key:"name",render:function(t,a){return t("div",[t("i-input",{attrs:{id:"edit-name-"+a.index,placeholder:"名称",value:a.row.name},on:{"on-blur":function(t){e.rows[a.index].name=t.target.value}}})])}},{title:"类型",key:"dataType",render:function(t,a){return t("div",[t("Select",{attrs:{id:"edit-name-"+a.index,value:a.row.dataType},on:{"on-change":function(t){return e.rows[a.index].dataType=t,"object"===t?(e.rows[a.index].children.push({name:"",description:"",dataType:"string",example:"",required:!1,children:[],_expanded:!1}),e.rows[a.index]._expanded=!0):(e.rows[a.index].children=[],e.rows[a.index]._expanded=!1),t}}},[t("Option",{props:{value:"array"}},"array"),t("Option",{props:{value:"boolean"}},"boolean"),t("Option",{props:{value:"file"}},"file"),t("Option",{props:{value:"string"}},"string"),t("Option",{props:{value:"object"}},"object")])])}},{title:"键（可选）",key:"address",render:function(e,t){return e("div",[e("i-input",{attrs:{id:"edit-describe-"+t.index,value:t.row.description,placeholder:"描述"}})])}},{title:"描述",key:"address",render:function(e,t){return e("div",[e("i-switch",{attrs:{id:"edit-name-"+t.index}})])}},{title:"添加",key:"action",width:60,align:"center",renderHeader:function(t,a){var n=e;return t("div",[t("Button",{props:{shape:"circle",size:"small",icon:"md-add"},style:{},on:{click:function(){n.rows.push({name:"",description:"",dataType:"string",example:"",required:!1,children:[],_expanded:!1})}}})])},render:function(t,a){return t("div",[t("Button",{props:{shape:"circle",size:"small",icon:"md-remove"},style:{marginRight:"5px"},on:{click:function(){e.rows.splice(a.index,1)}}})])}}]}},methods:{init:function(){},deleteDataModel:function(e,t){var a=this;Object(r["k"])(e,(function(e){"0"===e.header.code?(a.$Message.success("删除成功！"),a.rows.splice(t,1)):a.$Message.error(e.header.message)}))}},watch:{rows:{handler:function(e,t){this.$emit("childrenChange",e)},deep:!0}},mounted:function(){this.init()}},s=i,l=(a("f14d"),a("2877")),c=Object(l["a"])(s,n,o,!1,null,null,null);t["a"]=c.exports},d44b:function(e,t,a){},d885:function(e,t,a){},f14d:function(e,t,a){"use strict";var n=a("d885"),o=a.n(n);o.a},fe6c:function(e,t,a){}}]);